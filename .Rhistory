ggplot_KS(KS_SFD_PM10_l)
library(SpatFD)
library(gstat)
# Load data and coordinates
data(AirQualityBogota)
#s_0 nonsampled location. It could be data.frame or matrix and one or more locations of interest
newcoorden=data.frame(X=seq(93000,105000,len=100),Y=seq(97000,112000,len=100))
# Building the SpatFD object
SFD_PM10 <- SpatFD(PM10, coords = coord[, -1], basis = "Bsplines", nbasis = 17,norder=5, lambda = 0.00002, nharm=3)
# Semivariogram models for each spatial random field of scores
modelos <- list(vgm(psill = 2199288.58, "Wav", range = 1484.57, nugget =  0),
vgm(psill = 62640.74, "Mat", range = 1979.43, nugget = 0,kappa=0.68),
vgm(psill =37098.25, "Exp", range = 6433.16, nugget =  0))
KS_SFD_PM10_sc <- KS_scores_lambdas(SFD_PM10, newcoorden, method = "scores", model = modelos)
KS_SFD_PM10_l <- KS_scores_lambdas(SFD_PM10, newcoorden ,method = "lambda", model = modelos)
KS_SFD_PM10_both <- KS_scores_lambdas(SFD_PM10, newcoorden, method = "both", model = modelos)
ggplot_KS(KS_SFD_PM10_l)
ggplot_KS(KS_SFD_PM10_both,show.varpred = FALSE,
main = "Plot 1 - Using Scores",
main2 = "Plot 2 - Using Lambda",
ylab = "PM10")
ggplot_KS(KS_SFD_PM10_both)
ggmap_KS(KS_SFD_PM10_both,
map_path = map,
window_time = c(2108),
method = "lambda",
zmin = 50,
zmax = 120)
cokrig = COKS_scores_lambdas(SFD_PM10_NO2, newcoords, model1)
library(SpatFD)
data(COKMexico)
# Definimos nuestro objeto SpatFD
SFD_PM10_NO2 <- SpatFD(Mex_PM10, coords = coord_PM10, basis = "Fourier",
nbasis = 21, lambda = 0.000001, nharm = 2)
# Agregamos las observaciones de NO2 al objeto que creamos antes por medio del argumento add
SFD_PM10_NO2 <- SpatFD(NO2, coords = coord_NO2, basis = "Fourier",
nbasis = 27, lambda = 0.000001, nharm = 2,
add = SFD_PM10_NO2)
# Definimos los modelos de varianza de cada una de las variables
model1 <- gstat::vgm(647677.1,"Gau",23317.05)
model1 <- gstat::vgm(127633,"Wav",9408.63, add.to = model1)
# Especificamos la ubicaciÃ³n no muestreada
newcoords <- data.frame(x = 509926, y = 2179149)
cokrig = COKS_scores_lambdas(SFD_PM10_NO2, newcoords, model1)
str(cokrig)
cokrig$SFD
cokrig$modelfit

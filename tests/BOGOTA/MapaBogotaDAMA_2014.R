rm(list=ls())
require(MASS)
require(akima)
require(gstat)
require(geoR)
require(lattice)
require(maptools)
require(rgdal)
poligonos=readShapePoly("BOGOTA/Bogota.shp")
#plot(poligonos,axes=T)
muestra=spsample(poligonos,type="regular",n=100)
muestra1=as.data.frame(muestra)
names(muestra1)=c("x","y")
gridded(muestra1)=c("x","y")
datos=read.table("Coordenadas_planas_Estaciones_Dama_2014.txt",dec=",",sep="\t",header=T,row.names=1)
estaciones=rownames(datos)
datos1=datos
datos$Z=rep(1,10)
xy=SpatialPoints(datos[c("X","Y")])
coordinates(datos)=c("X","Y")
li=list("sp.polygons",poligonos,lwd=2,lty=1,type="s")
pts=list("sp.points",xy,pch=19,col="black",cex=1)
d1=list("SpatialPolygonsRescale",layout.north.arrow(),offset=c(90000,123500),scale=2500)
d2=list("SpatialPolygonsRescale",layout.scale.bar(),offset=c(85000,120000),scale=10000,fill=c("transparent","black"))
d3=list("sp.text",c(85000,122000),"0")
d4=list("sp.text",c(93500,122000),"5000m")
d5=list("sp.pointLabel",xy,label=c("Bsq","IDRD","Sony","EscIng","Corpas","Fontbn","PtAran","MAVDT","Knedy","Tunal"),cex=0.7)
pru=idw(Z~1,datos,newdata=muestra1,idp=1.5)
spplot(pru,c("var1.pred"),as.table=F,main="",scales=list(draw=F),sp.layout=list(li,pts,d1,d2,d3,d4,d5),contour=F,labels=T,pretty=T,col="red",col.regions="transparent",colorkey = FALSE,xlim=c(83500,110500),ylim=c(85000,127000),col.scales="transparent")

